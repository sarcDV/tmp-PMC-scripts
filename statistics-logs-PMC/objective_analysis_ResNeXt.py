import numpy as np
import matplotlib.pyplot as plt

def ccorrel(p1, p2):
    a = p1
    b = p2
    a = (a - np.mean(a)) / (np.std(a) * len(a))
    b = (b - np.mean(b)) / (np.std(b))
    c = np.correlate(a, b)
    
    return c

#########################################
##### Load DATA #########################
#########################################
##################################################
###################################################

t1_off_ = np.array([8.4375,     8.29326923, 9.04567308, 8.81009615, 8.37980769, 9.08894231,
 					8.37740385, 8.13942308, 9.21875,    8.41586538, 8.52644231, 8.72115385,
 					8.29326923, 7.81009615, 8.33894231, 8.60096154, 9.33653846, 9.10096154,
 					8.58413462, 8.61538462, 9.04567308]) 
t1_on_ = np.array([8.35096154, 8.27644231, 8.95913462, 8.81730769, 8.24759615, 9.14182692,
 				   8.39423077, 8.09134615, 9.48557692, 8.47836538, 8.49759615, 8.95432692,
 				   8.25240385, 7.96875,    8.32211538, 7.63701923, 9.39182692, 9.35336538,
 				   8.76923077, 8.64903846, 8.89423077])

t2_off_ = np.array([9.6,        9.06666667, 9.4,        9.,         9.6,        8.33333333,
 				    9. ,        9.,         8.53333333, 9.53333333, 9.2,        8.86666667,
 					9.46666667, 9.13333333, 9.06666667, 9.33333333, 9. ,        9.,
 					9.33333333, 9.46666667, 9.       ]) 
t2_on_ = np.array([9.53333333, 9.13333333, 9.33333333, 9.,         9.2,        9.06666667,
 				   9.,         9.,         9.,         9.46666667, 9.6,        9.,
 				   9.33333333, 9.,         9.26666667, 9.2,        9.06666667, 9.,
 				   9.06666667, 9.26666667, 9.     ])

pd_off_ = np.array([9.,         9.,         9.,         9.,         9.,         8.66666667,
 					8.93333333, 9.,         8.53333333, 9.,         9.,         8.6,
 					9.,        9.,         9.,         9.,         9. ,        8.73333333,
 					9.,         9.06666667, 8.86666667]) 
pd_on_ = np.array([9.,         9.,         9.,         9.,         9.,         8.73333333,
 				   8.93333333, 9.,         8.33333333, 9.,         9.,         8.33333333,
                   9.,         9.,         9.,         8.93333333, 9.,         8.93333333,
                   9.,         9.,         9.      ])

t2s05_off_ = np.array([10.,         10.,          9.96666667, 10.,          9.96666667,  8.56666667,
 					   10.,          9.96666667,  8.56666667, 10.,         10.,         10.,
 					   10.,          9.86666667, 10.,         10.,          9.9,        10.,
 					   10.,         10.,         10.]) 
t2s05_on_ = np.array([ 9.96666667, 10.,          9.93333333, 10.,          9.93333333,  9.03333333,
 					   10.,          9.93333333,  8.9,        10.,         10.,          9.93333333,
 					   10.,          9.9,        10.,         10.,         10.,          9.96666667,
  					   9.96666667, 10.,          9.96666667])

t2s035_off_ = np.array([10.,         10.,         10.,         10.,          9.73333333,  8.1,
 						10.,          9.76666667,  8.96666667, 10.,          9.93333333, 10.,
  						9.93333333,  9.13333333, 10.,          9.53333333,  9.9,         9.96666667,
  						9.03333333,  9.73333333,  9.93333333]) 
t2s035_on_ = np.array([9.96666667, 10.,         10.,         10.,          9.7,         9.,
  					   9.96666667,  9.46666667,  8.9,         9.7,        10.,          9.86666667,
  					   9.96666667,  9.26666667, 10.,          9.83333333,  9.9,         9.93333333,
                       9.36666667,  9.53333333,  9.93333333])

t2s025_off_ = np.array([10.,          9.03333333,  9.33333333,  9.26666667,  9.,          3.1,
  						9.06666667,  8.96666667,  6.36666667,  9.1,         9.36666667,  9.2,
  						9.9,         8.43333333,  9.5,         9.03333333,  9.43333333,  9.13333333,
  						9. ,         9.,          9.26666667]) 
t2s025_on_ = np.array([9.13333333, 9.,         9.43333333, 9.03333333, 9.,         4.63333333,
 					   9.,         8.93333333, 6.26666667, 9.,         9.03333333, 9.03333333,
 					   9.1,        8.56666667, 9.,         5.3,        9.36666667, 9.06666667,
 					   8.66666667, 9.,         9.03333333])

import scipy.stats as stats

print(stats.wilcoxon(t1_off_, t1_on_))
print(stats.wilcoxon(t2_off_, t2_on_))
print(stats.wilcoxon(pd_off_, pd_on_))
print(stats.wilcoxon(t2s05_off_, t2s05_on_))
print(stats.wilcoxon(t2s035_off_, t2s035_on_))
print(stats.wilcoxon(t2s025_off_, t2s025_on_))

print('\n')
print(stats.ttest_rel(t1_off_, t1_on_))